<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Algorithmic Scaling and Statistical Properties â€¢ EpiStrainDynamics</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Algorithmic Scaling and Statistical Properties">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EpiStrainDynamics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Using-EpiStrainDynamics.html">Using EpiStrainDynamics</a></li>
    <li><a class="dropdown-item" href="../articles/algorithmic-scaling.html">Algorithmic Scaling and Statistical Properties</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-recovery.html">Parameter Recovery Tests</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/acefa-hubs/EpiStrainDynamics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Algorithmic Scaling and Statistical Properties</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/acefa-hubs/EpiStrainDynamics/blob/main/vignettes/articles/algorithmic-scaling.Rmd" class="external-link"><code>vignettes/articles/algorithmic-scaling.Rmd</code></a></small>
      <div class="d-none name"><code>algorithmic-scaling.Rmd</code></div>
    </div>

    
    
<p>This document demonstrates the algorithmic scaling properties and
statistical behavior of <code>EpiStrainDynamics</code> models,
addressing the following statistical software standards:</p>
<ul>
<li>Scaling of algorithmic efficiency with input data size</li>
<li>Predicted values on appropriate scale relative to input</li>
<li>Recovery of input scales under various assumptions</li>
<li>Trivial noise should not meaningfully change results</li>
<li>Robustness to different random seeds</li>
</ul>
<div class="section level2">
<h2 id="algorithmic-scaling-with-data-size">1. Algorithmic Scaling with Data Size<a class="anchor" aria-label="anchor" href="#algorithmic-scaling-with-data-size"></a>
</h2>
<p>We test how computation time scales with increasing amounts of input
data for both modeling approaches (random walk and p-spline) and across
different pathogen structures.</p>
<div class="section level3">
<h3 id="generate-test-data-at-multiple-scales">1.1 Generate Test Data at Multiple Scales<a class="anchor" aria-label="anchor" href="#generate-test-data-at-multiple-scales"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to generate synthetic data of various sizes</span></span>
<span><span class="va">generate_test_data</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_timepoints</span>, <span class="va">n_pathogens</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Generate dates</span></span>
<span>  <span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span>, </span>
<span>                    by <span class="op">=</span> <span class="st">"day"</span>, </span>
<span>                    length.out <span class="op">=</span> <span class="va">n_timepoints</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Generate synthetic pathogen proportions that sum to 1</span></span>
<span>  <span class="va">proportions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_timepoints</span> <span class="op">*</span> <span class="va">n_pathogens</span><span class="op">)</span>, </span>
<span>                       nrow <span class="op">=</span> <span class="va">n_timepoints</span>, </span>
<span>                       ncol <span class="op">=</span> <span class="va">n_pathogens</span><span class="op">)</span></span>
<span>  <span class="va">proportions</span> <span class="op">&lt;-</span> <span class="va">proportions</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">proportions</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Generate total cases with some temporal variation</span></span>
<span>  <span class="va">total_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_timepoints</span>, </span>
<span>                       lambda <span class="op">=</span> <span class="fl">100</span> <span class="op">+</span> <span class="fl">50</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">*</span><span class="va">pi</span>, length.out <span class="op">=</span> <span class="va">n_timepoints</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Allocate to pathogens - round to ensure integers</span></span>
<span>  <span class="va">pathogen_cases</span> <span class="op">&lt;-</span> <span class="va">proportions</span> <span class="op">*</span> <span class="va">total_cases</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    date <span class="op">=</span> <span class="va">dates</span>,</span>
<span>    cases <span class="op">=</span> <span class="va">total_cases</span>,</span>
<span>    pathogen1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pathogen_cases</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    pathogen2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pathogen_cases</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    pathogen3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pathogen_cases</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    pathogen4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pathogen_cases</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Test across different data sizes </span></span>
<span><span class="va">data_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">120</span>, <span class="fl">240</span>, <span class="fl">480</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="benchmark-random-walk-method">1.2 Benchmark Random Walk Method<a class="anchor" aria-label="anchor" href="#benchmark-random-walk-method"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rw_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  n_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pathogen_structure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_seconds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">data_sizes</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing n ="</span>, <span class="va">n</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">generate_test_data</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Single pathogen structure</span></span>
<span>  <span class="va">single_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single.html">single</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>    case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>    time <span class="op">=</span> <span class="st">'date'</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Multiple pathogen structure</span></span>
<span>  <span class="va">multi_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>    case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>    time <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>    component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pathogen1'</span>, <span class="st">'pathogen2'</span>, <span class="st">'pathogen3'</span>, <span class="st">'pathogen4'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Time single pathogen </span></span>
<span>  <span class="va">model_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="va">single_struct</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">time_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model_single</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">500</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">rw_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rw_timings</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    n_timepoints <span class="op">=</span> <span class="va">n</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"random_walk"</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="st">"single"</span>,</span>
<span>    time_seconds <span class="op">=</span> <span class="va">time_single</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Time multiple pathogens </span></span>
<span>  <span class="va">model_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="va">multi_struct</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">time_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model_multi</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">500</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">rw_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rw_timings</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    n_timepoints <span class="op">=</span> <span class="va">n</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"random_walk"</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="st">"multiple"</span>,</span>
<span>    time_seconds <span class="op">=</span> <span class="va">time_multi</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Testing n = 30</span></span>
<span><span class="co">#&gt; Testing n = 60</span></span>
<span><span class="co">#&gt; Testing n = 120</span></span>
<span><span class="co">#&gt; Testing n = 240</span></span>
<span><span class="co">#&gt; Testing n = 480</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="benchmark-p-spline-method">1.3 Benchmark P-Spline Method<a class="anchor" aria-label="anchor" href="#benchmark-p-spline-method"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  n_timepoints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pathogen_structure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_seconds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="va">data_sizes</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Testing n ="</span>, <span class="va">n</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">generate_test_data</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">single_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single.html">single</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>    case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>    time <span class="op">=</span> <span class="st">'date'</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">multi_struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>    case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>    time <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>    component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pathogen1'</span>, <span class="st">'pathogen2'</span>, <span class="st">'pathogen3'</span>, <span class="st">'pathogen4'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Time single pathogen</span></span>
<span>  <span class="va">model_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/p_spline.html">p_spline</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="va">single_struct</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">time_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model_single</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">500</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ps_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ps_timings</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    n_timepoints <span class="op">=</span> <span class="va">n</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"p_spline"</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="st">"single"</span>,</span>
<span>    time_seconds <span class="op">=</span> <span class="va">time_single</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Time multiple pathogens </span></span>
<span>  <span class="va">model_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/p_spline.html">p_spline</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="va">multi_struct</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">time_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model_multi</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">500</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ps_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">ps_timings</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    n_timepoints <span class="op">=</span> <span class="va">n</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"p_spline"</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="st">"multiple"</span>,</span>
<span>    time_seconds <span class="op">=</span> <span class="va">time_multi</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Testing n = 30</span></span>
<span><span class="co">#&gt; Testing n = 60</span></span>
<span><span class="co">#&gt; Testing n = 120</span></span>
<span><span class="co">#&gt; Testing n = 240</span></span>
<span><span class="co">#&gt; Testing n = 480</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualize-scaling-behavior">1.4 Visualize Scaling Behavior<a class="anchor" aria-label="anchor" href="#visualize-scaling-behavior"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine all timings</span></span>
<span><span class="va">all_timings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">rw_timings</span>, <span class="va">ps_timings</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create log-log plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">all_timings</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">n_timepoints</span>, y <span class="op">=</span> <span class="va">time_seconds</span>, </span>
<span>                        color <span class="op">=</span> <span class="va">method</span>, linetype <span class="op">=</span> <span class="va">pathogen_structure</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">data_sizes</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Algorithmic Scaling: Computation Time vs Data Size"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Log-log plot showing near-linear scaling"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Number of Time Points (log scale)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Computation Time (seconds, log scale)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Method"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Pathogen Structure"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algorithmic-scaling_files/figure-html/plot-scaling-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="quantify-scaling-coefficients">1.5 Quantify Scaling Coefficients<a class="anchor" aria-label="anchor" href="#quantify-scaling-coefficients"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit linear models on log-log scale to estimate scaling exponent</span></span>
<span><span class="va">scaling_results</span> <span class="op">&lt;-</span> <span class="va">all_timings</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">method</span>, <span class="va">pathogen_structure</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    <span class="co"># Fit log(time) ~ log(n)</span></span>
<span>    scaling_exponent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">time_seconds</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n_timepoints</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    r_squared <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">time_seconds</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n_timepoints</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">r.squared</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">scaling_results</span>, digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Scaling exponents: time complexity approximately O(n^exponent)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Scaling exponents: time complexity approximately
O(n^exponent)</caption>
<thead><tr class="header">
<th align="left">method</th>
<th align="left">pathogen_structure</th>
<th align="right">scaling_exponent</th>
<th align="right">r_squared</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">p_spline</td>
<td align="left">multiple</td>
<td align="right">0.990</td>
<td align="right">0.998</td>
</tr>
<tr class="even">
<td align="left">p_spline</td>
<td align="left">single</td>
<td align="right">0.924</td>
<td align="right">0.987</td>
</tr>
<tr class="odd">
<td align="left">random_walk</td>
<td align="left">multiple</td>
<td align="right">0.920</td>
<td align="right">0.995</td>
</tr>
<tr class="even">
<td align="left">random_walk</td>
<td align="left">single</td>
<td align="right">0.951</td>
<td align="right">0.998</td>
</tr>
</tbody>
</table>
<p><strong>Interpretation</strong>: Exponents close to 1.0 indicate
linear scaling O(n), which is expected for these Bayesian time series
models. Values slightly above 1.0 may indicate some overhead from MCMC
sampling that scales slightly super-linearly.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="predicted-values-on-appropriate-scale">2. Predicted Values on Appropriate Scale<a class="anchor" aria-label="anchor" href="#predicted-values-on-appropriate-scale"></a>
</h2>
<p>We verify that fitted/predicted values are on the same scale as the
input data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use package data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit model </span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pathogen_structure <span class="op">=</span> <span class="fu"><a href="../reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarscov2</span>,</span>
<span>    case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>    time <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>    component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'delta'</span>, <span class="st">'omicron'</span>, <span class="st">'other'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">1000</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract incidence (predicted values)</span></span>
<span><span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">fit</span>, dow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">inc_total_values</span> <span class="op">&lt;-</span> <span class="va">inc</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">inc</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">pathogen</span> <span class="op">==</span> <span class="st">'Total'</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Compare scales</span></span>
<span><span class="va">input_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"min"</span>, <span class="st">"median"</span>, <span class="st">"mean"</span>, <span class="st">"max"</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>  input_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  predicted_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">input_summary</span><span class="op">$</span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="va">input_summary</span><span class="op">$</span><span class="va">predicted_cases</span> <span class="op">/</span> <span class="va">input_summary</span><span class="op">$</span><span class="va">input_cases</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">input_summary</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Comparison of input and predicted case scales"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Comparison of input and predicted case scales</caption>
<thead><tr class="header">
<th align="left">metric</th>
<th align="right">input_cases</th>
<th align="right">predicted_cases</th>
<th align="right">ratio</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">min</td>
<td align="right">1433.00</td>
<td align="right">1876.00</td>
<td align="right">1.31</td>
</tr>
<tr class="even">
<td align="left">median</td>
<td align="right">18286.50</td>
<td align="right">18271.00</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">mean</td>
<td align="right">28653.21</td>
<td align="right">28608.14</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">max</td>
<td align="right">275647.00</td>
<td align="right">267464.25</td>
<td align="right">0.97</td>
</tr>
<tr class="odd">
<td align="left">sd</td>
<td align="right">34268.32</td>
<td align="right">33920.50</td>
<td align="right">0.99</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visual comparison</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  observed <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span>,</span>
<span>  predicted <span class="op">=</span> <span class="va">inc_total_values</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">observed</span>, color <span class="op">=</span> <span class="st">"Observed"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">predicted</span>, color <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Input vs Predicted Values: Scale Verification"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Predicted values should match the scale of observed data"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Cases"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algorithmic-scaling_files/figure-html/plot-scale-comparison-1.png" class="r-plt" width="672"></p>
<p><strong>Conclusion</strong>: Predicted values are on the same scale
as input data, with similar ranges and distributions.</p>
<hr>
</div>
<div class="section level2">
<h2 id="scale-recovery-under-different-assumptions">3. Scale Recovery Under Different Assumptions<a class="anchor" aria-label="anchor" href="#scale-recovery-under-different-assumptions"></a>
</h2>
<p>Test whether the model correctly recovers input scales when data have
different properties (non-zero means, different magnitudes, etc.).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Test with data at different scales </span></span>
<span><span class="va">test_scales</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">recovery_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  input_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  input_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  predicted_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  relative_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">scale</span> <span class="kw">in</span> <span class="va">test_scales</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Generate data at this scale</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span>  <span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">generate_test_data</span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="co"># Scale and round to ensure integer counts</span></span>
<span>  <span class="va">test_data</span><span class="op">$</span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">cases</span> <span class="op">*</span> <span class="op">(</span><span class="va">scale</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Fit model</span></span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="fu"><a href="../reference/single.html">single</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>      case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>      time <span class="op">=</span> <span class="st">'date'</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">500</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">fit</span>, dow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">inc_total_values</span> <span class="op">&lt;-</span> <span class="va">inc</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">y</span></span>
<span>  </span>
<span>  <span class="co"># Record results</span></span>
<span>  <span class="va">recovery_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">recovery_results</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    input_scale <span class="op">=</span> <span class="va">scale</span>,</span>
<span>    input_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>,</span>
<span>    predicted_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span>,</span>
<span>    relative_error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">inc_total_values</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">recovery_results</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Scale recovery across different input magnitudes"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Scale recovery across different input magnitudes</caption>
<thead><tr class="header">
<th align="right">input_scale</th>
<th align="right">input_mean</th>
<th align="right">predicted_mean</th>
<th align="right">relative_error</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">10.00</td>
<td align="right">9.66</td>
<td align="right">0.03</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">100.00</td>
<td align="right">101.57</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">999.98</td>
<td align="right">999.51</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">recovery_results</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">input_mean</span>, y <span class="op">=</span> <span class="va">predicted_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_log10</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Scale Recovery Test"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Perfect recovery would lie on the red diagonal"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Input Mean (log scale)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Predicted Mean (log scale)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="algorithmic-scaling_files/figure-html/plot-scale-recovery-1.png" class="r-plt" width="672"></p>
<p><strong>Conclusion</strong>: The model successfully recovers scales
across multiple orders of magnitude.</p>
<hr>
</div>
<div class="section level2">
<h2 id="robustness-to-trivial-noise">4. Robustness to Trivial Noise<a class="anchor" aria-label="anchor" href="#robustness-to-trivial-noise"></a>
</h2>
<p>Test whether adding small amounts of noise to the input data
meaningfully changes results.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit model to original data </span></span>
<span><span class="va">model_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pathogen_structure <span class="op">=</span> <span class="fu"><a href="../reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarscov2</span>,</span>
<span>    case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>    time <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>    component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'delta'</span>, <span class="st">'omicron'</span>, <span class="st">'other'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model_original</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                          seed <span class="op">=</span> <span class="fl">54321</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">inc_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">fit_original</span>, dow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">inc_original_total</span> <span class="op">&lt;-</span> <span class="va">inc_original</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">inc_original</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">pathogen</span> <span class="op">==</span> <span class="st">'Total'</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Test with different noise levels </span></span>
<span><span class="va">noise_levels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># 5%, 10% noise relative to mean</span></span>
<span><span class="va">noise_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">noise_level</span> <span class="kw">in</span> <span class="va">noise_levels</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Add Poisson noise scaled to the noise level</span></span>
<span>  <span class="co"># Use round to ensure integer counts</span></span>
<span>  <span class="va">noisy_cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span> <span class="op">+</span> </span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span>, </span>
<span>                                      mean <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                                      sd <span class="op">=</span> <span class="va">noise_level</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Also add proportional noise to pathogen counts</span></span>
<span>  <span class="va">sarscov2_noisy</span> <span class="op">&lt;-</span> <span class="va">sarscov2</span></span>
<span>  <span class="va">sarscov2_noisy</span><span class="op">$</span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="va">noisy_cases</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">pathogen</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'delta'</span>, <span class="st">'omicron'</span>, <span class="st">'other'</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">sarscov2_noisy</span><span class="op">[[</span><span class="va">pathogen</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>      <span class="va">sarscov2</span><span class="op">[[</span><span class="va">pathogen</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">[[</span><span class="va">pathogen</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                                   mean <span class="op">=</span> <span class="fl">0</span>, </span>
<span>                                   sd <span class="op">=</span> <span class="va">noise_level</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">[[</span><span class="va">pathogen</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Fit model to noisy data </span></span>
<span>  <span class="va">model_noisy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="fu"><a href="../reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">sarscov2_noisy</span>,</span>
<span>      case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>      time <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>      component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'delta'</span>, <span class="st">'omicron'</span>, <span class="st">'other'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fit_noisy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model_noisy</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                        seed <span class="op">=</span> <span class="fl">54321</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">inc_noisy</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">fit_noisy</span>, dow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">noise_results</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">noise_level</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">inc_noisy</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">inc_noisy</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">pathogen</span> <span class="op">==</span> <span class="st">'Total'</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="quantify-impact-of-noise">4.1 Quantify Impact of Noise<a class="anchor" aria-label="anchor" href="#quantify-impact-of-noise"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate correlation and RMSE for each noise level</span></span>
<span><span class="va">noise_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  noise_level <span class="op">=</span> <span class="va">noise_levels</span>,</span>
<span>  correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">noise_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">inc_original_total</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">noise_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">inc_original_total</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  relative_rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">noise_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">inc_original_total</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">inc_original_total</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span>,</span>
<span>  mean_difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">noise_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">inc_original_total</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">noise_comparison</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Impact of trivial noise on model results"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Impact of trivial noise on model results</caption>
<colgroup>
<col width="7%">
<col width="17%">
<col width="17%">
<col width="13%">
<col width="20%">
<col width="23%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">noise_level</th>
<th align="right">correlation</th>
<th align="right">rmse</th>
<th align="right">relative_rmse</th>
<th align="right">mean_difference</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">0.05</td>
<td align="right">0.05</td>
<td align="right">0.9750</td>
<td align="right">7585.635</td>
<td align="right">0.2649</td>
<td align="right">3444.908</td>
</tr>
<tr class="even">
<td align="left">0.1</td>
<td align="right">0.10</td>
<td align="right">0.9743</td>
<td align="right">7678.565</td>
<td align="right">0.2682</td>
<td align="right">3653.819</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nInterpretation:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interpretation:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Correlations &gt; 0.95 indicate noise has minimal impact\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Correlations &gt; 0.95 indicate noise has minimal impact</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Relative RMSE &lt; 0.05 indicates differences are small relative to scale\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; - Relative RMSE &lt; 0.05 indicates differences are small relative to scale</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualize-noise-impact">4.2 Visualize Noise Impact<a class="anchor" aria-label="anchor" href="#visualize-noise-impact"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for plotting</span></span>
<span><span class="va">noise_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">date</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">noise_levels</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">inc_original_total</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">noise_results</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Noise "</span>, <span class="va">noise_levels</span> <span class="op">*</span> <span class="fl">100</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">inc_original_total</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">noise_plot_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cases</span>, color <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Robustness to Trivial Noise in Input Data"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Model predictions with varying levels of added noise"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Predicted Total Cases"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Condition"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algorithmic-scaling_files/figure-html/plot-noise-impact-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot differences from original</span></span>
<span><span class="va">diff_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">date</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">noise_levels</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">noise_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">-</span> <span class="va">inc_original_total</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  noise_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">noise_levels</span> <span class="op">*</span> <span class="fl">100</span>, <span class="st">"% noise"</span><span class="op">)</span>, </span>
<span>                    each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">inc_original_total</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">diff_plot_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">difference</span>, color <span class="op">=</span> <span class="va">noise_level</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Difference from Original Predictions"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Deviations should be small relative to the signal"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Difference in Predicted Cases"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Noise Level"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algorithmic-scaling_files/figure-html/plot-noise-differences-1.png" class="r-plt" width="672"></p>
<p><strong>Conclusion</strong>: The model is robust to trivial noise in
input data. Correlations remain high (&gt;0.95) and relative differences
are small even with 10% noise, indicating that small measurement errors
or data quality issues do not substantially affect results.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="robustness-to-random-seeds">5. Robustness to Random Seeds<a class="anchor" aria-label="anchor" href="#robustness-to-random-seeds"></a>
</h2>
<p>Test whether different random seeds produce meaningfully similar
results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to fit model with a given seed </span></span>
<span><span class="va">fit_with_seed</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">seed</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="fu"><a href="../reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    pathogen_structure <span class="op">=</span> <span class="fu"><a href="../reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">sarscov2</span>,</span>
<span>      case_timeseries <span class="op">=</span> <span class="st">'cases'</span>,</span>
<span>      time <span class="op">=</span> <span class="st">'date'</span>,</span>
<span>      component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'alpha'</span>, <span class="st">'delta'</span>, <span class="st">'omicron'</span>, <span class="st">'other'</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">model</span>, n_chain <span class="op">=</span> <span class="fl">2</span>, n_iter <span class="op">=</span> <span class="fl">1000</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">inc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/incidence.html">incidence</a></span><span class="op">(</span><span class="va">fit</span>, dow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="va">inc</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">inc</span><span class="op">$</span><span class="va">measure</span><span class="op">$</span><span class="va">pathogen</span> <span class="op">==</span> <span class="st">'Total'</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Fit with different seeds</span></span>
<span><span class="va">seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123</span>, <span class="fl">101112</span><span class="op">)</span></span>
<span><span class="va">results_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">seeds</span>, <span class="va">fit_with_seed</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare results</span></span>
<span><span class="va">results_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="va">results_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">results_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"seed_"</span>, <span class="va">seeds</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate coefficient of variation across seeds for each time point</span></span>
<span><span class="va">cv_across_seeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">results_matrix</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seed_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mean CV"</span>, <span class="st">"Median CV"</span>, <span class="st">"Max CV"</span>, <span class="st">"95th percentile CV"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cv_across_seeds</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">cv_across_seeds</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cv_across_seeds</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">cv_across_seeds</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">seed_summary</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Coefficient of variation across different random seeds"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Coefficient of variation across different random
seeds</caption>
<thead><tr class="header">
<th align="left">metric</th>
<th align="right">value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Mean CV</td>
<td align="right">0.0060</td>
</tr>
<tr class="even">
<td align="left">Median CV</td>
<td align="right">0.0040</td>
</tr>
<tr class="odd">
<td align="left">Max CV</td>
<td align="right">0.0421</td>
</tr>
<tr class="even">
<td align="left">95th percentile CV</td>
<td align="right">0.0189</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot results from different seeds</span></span>
<span><span class="va">seed_plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">sarscov2</span><span class="op">$</span><span class="va">date</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">seeds</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">results_matrix</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Seed "</span>, <span class="va">seeds</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">results_matrix</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">seed_plot_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cases</span>, color <span class="op">=</span> <span class="va">seed</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Results Across Different Random Seeds"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Lines should be nearly overlapping if robust to seed choice"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Predicted Cases"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Random Seed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="algorithmic-scaling_files/figure-html/plot-seed-robustness-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate pairwise correlations between seed results</span></span>
<span><span class="va">cor_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">results_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">cor_matrix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nPairwise correlations between results from different seeds:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pairwise correlations between results from different seeds:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_matrix</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             seed_123 seed_101112</span></span>
<span><span class="co">#&gt; seed_123          NA           1</span></span>
<span><span class="co">#&gt; seed_101112        1          NA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMean pairwise correlation:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cor_matrix</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean pairwise correlation: 1</span></span></code></pre></div>
<p><strong>Conclusion</strong>: High correlations (&gt;0.99) between
runs with different seeds indicate that results are robust and not
meaningfully affected by random seed choice.</p>
<hr>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This document demonstrates that <code>EpiStrainDynamics</code>:</p>
<ol style="list-style-type: decimal">
<li>Exhibits approximately linear scaling O(n) with input data size,
making it computationally efficient for real-world surveillance
data</li>
<li>Produces predicted values on the same scale as input data</li>
<li>Successfully recovers input scales across multiple orders of
magnitude</li>
<li>Is robust to trivial noise in input data, with minimal impact on
predictions</li>
<li>Produces robust, reproducible results regardless of random seed
choice</li>
</ol>
<hr>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] dplyr_1.1.4                  ggplot2_4.0.1               </span></span>
<span><span class="co">#&gt; [3] EpiStrainDynamics_0.0.0.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] viridis_0.6.5         sass_0.4.10           generics_0.1.4       </span></span>
<span><span class="co">#&gt;  [4] anytime_0.3.12        digest_0.6.39         magrittr_2.0.4       </span></span>
<span><span class="co">#&gt;  [7] timechange_0.3.0      evaluate_1.0.5        grid_4.5.2           </span></span>
<span><span class="co">#&gt; [10] RColorBrewer_1.1-3    fastmap_1.2.0         jsonlite_2.0.0       </span></span>
<span><span class="co">#&gt; [13] pkgbuild_1.4.8        gridExtra_2.3         purrr_1.2.0          </span></span>
<span><span class="co">#&gt; [16] viridisLite_0.4.2     QuickJSR_1.8.1        scales_1.4.0         </span></span>
<span><span class="co">#&gt; [19] codetools_0.2-20      textshaping_1.0.4     jquerylib_0.1.4      </span></span>
<span><span class="co">#&gt; [22] cli_3.6.5             rlang_1.1.6           ellipsis_0.3.2       </span></span>
<span><span class="co">#&gt; [25] splines_4.5.2         withr_3.0.2           cachem_1.1.0         </span></span>
<span><span class="co">#&gt; [28] yaml_2.3.12           StanHeaders_2.32.10   tools_4.5.2          </span></span>
<span><span class="co">#&gt; [31] rstan_2.32.7          inline_0.3.21         parallel_4.5.2       </span></span>
<span><span class="co">#&gt; [34] rstantools_2.5.0      tsibble_1.1.6         vctrs_0.6.5          </span></span>
<span><span class="co">#&gt; [37] R6_2.6.1              lubridate_1.9.4       matrixStats_1.5.0    </span></span>
<span><span class="co">#&gt; [40] stats4_4.5.2          lifecycle_1.0.4       fs_1.6.6             </span></span>
<span><span class="co">#&gt; [43] ragg_1.5.0            pkgconfig_2.0.3       desc_1.4.3           </span></span>
<span><span class="co">#&gt; [46] pkgdown_2.2.0         RcppParallel_5.1.11-1 pillar_1.11.1        </span></span>
<span><span class="co">#&gt; [49] bslib_0.9.0           gtable_0.3.6          loo_2.8.0            </span></span>
<span><span class="co">#&gt; [52] glue_1.8.0            Rcpp_1.1.0            systemfonts_1.3.1    </span></span>
<span><span class="co">#&gt; [55] xfun_0.55             tibble_3.3.0          tidyselect_1.2.1     </span></span>
<span><span class="co">#&gt; [58] knitr_1.50            farver_2.1.2          bayesplot_1.15.0     </span></span>
<span><span class="co">#&gt; [61] htmltools_0.5.9       labeling_0.4.3        rmarkdown_2.30       </span></span>
<span><span class="co">#&gt; [64] compiler_4.5.2        S7_0.2.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Saras Windecker, Oliver Eales, James McCaw, Freya Shearer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
