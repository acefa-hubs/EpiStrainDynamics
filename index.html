<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Infer temporal trends of multiple pathogens • EpiStrainDynamics</title>
<script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Infer temporal trends of multiple pathogens">
<meta name="description" content="EpiStrainDynamics is a statistical framework developed for inferring temporal trends of multiple pathogens from routinely collected surveillance data.">
<meta property="og:description" content="EpiStrainDynamics is a statistical framework developed for inferring temporal trends of multiple pathogens from routinely collected surveillance data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">EpiStrainDynamics</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/Using-EpiStrainDyamics.html">Using EpiStainDynamics</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/acefa-hubs/EpiStrainDynamics/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="epistraindynamics">EpiStrainDynamics<a class="anchor" aria-label="anchor" href="#epistraindynamics"></a>
</h1></div>
<p><a href="https://app.codecov.io/gh/acefa-hubs/EpiStrainDynamics" class="external-link"><img src="https://codecov.io/gh/acefa-hubs/EpiStrainDynamics/graph/badge.svg" alt="codecov"></a> <a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg"></a> <a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a></p>
<p>This repository contains code corresponding to the R package <code>EpiStrainDynamics</code>. For code corresponding to the analyses in the paper: <em>Inferring temporal trends of multiple pathogens, variants, subtypes or serotypes from routine surveillance data</em>, see branch <a href="https://github.com/acefa-hubs/EpiStrainDynamics/tree/paper_analysis" class="external-link"><code>paper_analysis</code></a>.</p>
<p>Estimating the temporal trends in infectious disease activity is crucial for monitoring disease spread and the impact of interventions. Surveillance indicators routinely collected to monitor these trends are often a composite of multiple pathogens. For example, ‘influenza-like illness’ — routinely monitored as a proxy for influenza infections — is a symptom definition that could be caused by a wide range of pathogens, including multiple subtypes of influenza, SARS-CoV-2, and RSV. Inferred trends from such composite time series may not reflect the trends of any one of the component pathogens, each of which can exhibit distinct dynamics. Although many surveillance systems routinely test a subset of individuals contributing to a surveillance indicator — providing information on the relative contribution of the component pathogens — trends may be obscured by time-varying testing rates or substantial noise in the observation process.</p>
<p>EpiStrainDynamics extends an existing statistical modelling framework capable of inferring the trends of up to two pathogens. The modeling framework has been extended here to handle any number of pathogens; fit to time series data of counts (eg, daily number of cases); incorporate influenza testing data in which the subtype for influenza A samples may be undetermined; account for day-of-the-week effects in daily data; include options for fitting penalized splines or random walks; support additional (optional) correlation structures in the parameters describing the smoothness of the penalized splines (or random walks); and account for additional (optional) sources of noise in the observation process.</p>
</div>
<div class="section level1">
<h1 id="step-1-construct-model">Step 1: Construct model<a class="anchor" aria-label="anchor" href="#step-1-construct-model"></a>
</h1>
<p>Modelling specifications are provided using the <code>construct_model</code> function. The correct stan model is then applied based on the specifications provided. <code><a href="reference/construct_model.html">construct_model()</a></code> takes three arguments: <code>method</code>, <code>pathogen_structure</code>, and <code>dow_effect</code>.</p>
<div class="section level2">
<h2 id="method">Method<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>EpiStrainDynamics has pre-compiled stan models that fit either with bayesian penalised splines or random walks. These are specified using the <code>method</code> argument of <code><a href="reference/construct_model.html">construct_model()</a></code> as functions, either with <code><a href="reference/random_walk.html">random_walk()</a></code> or <code><a href="reference/p_spline.html">p_spline()</a></code>. The penalised spline model has two further options to specify: <code>spline_degree</code> is the polynomial degree of the individual spline segments used to construct the overall curve (must be a positive whole number) and <code>days_per_knot</code>, which is the number of days for each knot (must also be a positive whole number).</p>
<p>So we may specify:</p>
<pre><code><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="fu"><a href="reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># OR</span></span>
<span></span>
<span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="fu"><a href="reference/p_spline.html">p_spline</a></span><span class="op">(</span>spline_degree <span class="op">=</span> <span class="fl">3</span>, days_per_knot <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,  <span class="co"># example options</span></span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="pathogen-structure">Pathogen structure<a class="anchor" aria-label="anchor" href="#pathogen-structure"></a>
</h2>
<p>There are three main types of pathogen structure available to model: <code><a href="reference/single.html">single()</a></code>, <code><a href="reference/multiple.html">multiple()</a></code>, and <code><a href="reference/subtyped.html">subtyped()</a></code>.</p>
<p>The <code><a href="reference/single.html">single()</a></code> pathogen structure is the simplest and models a single pathogen timeseries. A vector is the case timeseries is provided to the argument <code>case_timeseries</code>, a vector of date or time labels is provided to <code>time</code>, and optionally a pathogen name can be assigned with <code>pathogen_name</code>. It can be specified as follows, illustrated using data provided with the package <code>sarscov2</code>:</p>
<pre><code><span><span class="fu"><a href="reference/single.html">single</a></span><span class="op">(</span></span>
<span>  case_timeseries <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span>,           <span class="co"># timeseries of case data</span></span>
<span>  time <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">date</span>,                       <span class="co"># date or time variable labels</span></span>
<span>  pathogen_name <span class="op">=</span> <span class="st">'SARS-COV-2'</span>                <span class="co"># optional name of pathogen</span></span>
<span><span class="op">)</span></span></code></pre>
<p>The <code><a href="reference/multiple.html">multiple()</a></code> and <code><a href="reference/subtyped.html">subtyped()</a></code> pathogen structures both also have the <code>case_timeseries</code> and <code>time</code> arguments, as in the <code><a href="reference/single.html">single()</a></code> structure.</p>
<p>In addition to these two arguments, instead of a single argument for <code>pathogen_name</code>, <code><a href="reference/multiple.html">multiple()</a></code> and <code><a href="reference/subtyped.html">subtyped()</a></code> have one or more arguments that allow the user to define the names and data for the different components or subtypes to be modelled. For <code><a href="reference/multiple.html">multiple()</a></code>, these are specified as a named list with the argument <code>component_pathogen_timeseries</code>. The names in this list will be using in subsequent plotting. For <code><a href="reference/subtyped.html">subtyped()</a></code>, which allows the user to incorporate testing data for influenza A subtypes, a vector of total unsubtyped influenza A cases is specified with <code>influenzaA_unsubtyped_timeseries</code>, a named list of the subtyped influenza A timeseries is provided to <code>influenzaA_subtyped_timeseries</code>, and further pathogens are provided in a named list to <code>other_pathogen_timeseries</code>.</p>
<p>In addition to specifying the data and pathogen names, <code><a href="reference/multiple.html">multiple()</a></code> and <code><a href="reference/subtyped.html">subtyped()</a></code> both allow the user to modify the correlation structures in the parameters describing the smoothness (with argument <code>smoothing_structure</code>) and account for additional sources of noise in the observation process (<code>observation_noise</code>). <code>smoothing_structure</code> is either <code>'shared'</code> (all pathogens have the same smoothness), <code>'independent'</code> (each pathogen has completely independent smoothing structure), or <code>'correlated'</code> (smoothing structure is correlated among pathogens). <code>observation_noise</code> is either <code>'observation_noise_only'</code> (only includes observation noise - the same between pathogens) or <code>'pathogen_specific_noise'</code> (includes noise in individual pathogens as well).</p>
<p>Example pathogen structure specification for multiple pathogens model:</p>
<pre><code><span><span class="fu"><a href="reference/multiple.html">multiple</a></span><span class="op">(</span></span>
<span>   case_timeseries <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">cases</span>,        <span class="co"># timeseries of case data</span></span>
<span>   time <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">date</span>,                    <span class="co"># date or time variable labels</span></span>
<span></span>
<span>   component_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>    <span class="co"># named list of component pathogens</span></span>
<span>     alpha <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">alpha</span>,</span>
<span>     delta <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">delta</span>,</span>
<span>     omicron <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">omicron</span>,</span>
<span>     other <span class="op">=</span> <span class="va">sarscov2</span><span class="op">$</span><span class="va">other</span></span>
<span>   <span class="op">)</span>,</span>
<span></span>
<span>   smoothing_structure <span class="op">=</span> <span class="st">'independent'</span>,             <span class="co"># correlation structures</span></span>
<span>   observation_noise <span class="op">=</span> <span class="st">'observation_noise_only'</span>     <span class="co"># observation noise</span></span>
<span> <span class="op">)</span></span></code></pre>
<p>Example pathogen structure specification for subtyped model:</p>
<pre><code><span><span class="fu"><a href="reference/subtyped.html">subtyped</a></span><span class="op">(</span></span>
<span>   case_timeseries <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">ili</span>,         <span class="co"># timeseries of case data</span></span>
<span>   time <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">week</span>,                   <span class="co"># date or time variable labels</span></span>
<span></span>
<span>   influenzaA_unsubtyped_timeseries <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">inf_A</span>,  <span class="co"># unsubtyped influenzaA</span></span>
<span>   influenzaA_subtyped_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>       <span class="co"># named list of subtyped infA</span></span>
<span>     H3N2 <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">inf_H3N2</span>,</span>
<span>     H1N1 <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">inf_H1N1</span></span>
<span>   <span class="op">)</span>,</span>
<span>   other_pathogen_timeseries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>            <span class="co"># named list of other pathogens</span></span>
<span>     influenzaB <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">inf_B</span>,</span>
<span>     other <span class="op">=</span> <span class="va">influenza</span><span class="op">$</span><span class="va">num_spec</span> <span class="op">-</span> <span class="va">influenza</span><span class="op">$</span><span class="va">inf_all</span></span>
<span>   <span class="op">)</span>,</span>
<span></span>
<span>   smoothing_structure <span class="op">=</span> <span class="st">'correlated'</span>,            <span class="co"># correlation structures</span></span>
<span>   observation_noise <span class="op">=</span> <span class="st">'pathogen_specific_noise'</span>  <span class="co"># observation noise</span></span>
<span> <span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="day-of-week-effect">Day of week effect<a class="anchor" aria-label="anchor" href="#day-of-week-effect"></a>
</h2>
<p>Day of week effect is specified as a logical (<code>TRUE</code> or <code>FALSE</code>) to the <code>dow_effect</code> argument. In plotting the day of week effect can be selectively removed.</p>
<pre><code><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/construct_model.html">construct_model</a></span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="fu"><a href="reference/random_walk.html">random_walk</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  pathogen_structure <span class="op">=</span> <span class="va">...</span>,</span>
<span>  dow_effect <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level1">
<h1 id="step-2-fit-model">Step 2: fit model<a class="anchor" aria-label="anchor" href="#step-2-fit-model"></a>
</h1>
<p>The model estimates the expected value of the time series (eg, a smoothed trend in the daily number of cases accounting for noise) for each individual pathogen. Model parameterisation decisions specified when constructing the model in step 1 mean the correct stan model will be applied at this stage by simply calling <code><a href="reference/fit_model.html">fit_model()</a></code> onto the constructed model object.</p>
</div>
<div class="section level1">
<h1 id="step-3-calculate-and-visualise-epidemiological-quantities">Step 3: Calculate and visualise epidemiological quantities<a class="anchor" aria-label="anchor" href="#step-3-calculate-and-visualise-epidemiological-quantities"></a>
</h1>
<p>Calculate epidemic growth rate with <code>growth_rate(fit)</code>, effective reproduction number over time with <code>Rt(fit, gi_dist = X)</code> (requiring specification of a generation interval distribution X), incidence with or without a day of week effect with <code>incidence(fit, dow_effect = TRUE)</code>, and proportions of different combinations of cases attributable to different pathogens/subtypes using <code><a href="reference/proportion.html">proportion()</a></code>, where the pathogens/subtypes are specified by their names in the named lists provided to <code><a href="reference/construct_model.html">construct_model()</a></code>:</p>
<pre><code><span><span class="va">prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/proportion.html">proportion</a></span><span class="op">(</span></span>
<span>  <span class="va">fit</span>,</span>
<span>  numerator_combination <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'H3N2'</span>, <span class="st">'H1N1'</span>, <span class="st">'influenzaB'</span><span class="op">)</span>,</span>
<span>  denominator_combination <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'H3N2'</span>, <span class="st">'H1N1'</span>, <span class="st">'influenzaB'</span>, <span class="st">'other'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
<p>These quantities can be visualised using <code><a href="reference/plot.html">plot()</a></code>. For a more detailed discussion, check out the <a href="https://acefa-hubs.github.io/EpiStrainDynamics/articles/Using-EpiStrainDyamics.html">vignette</a>.</p>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Oliver Eales, Saras M Windecker, James M McCaw, Freya M Shearer, Inferring temporal trends of multiple pathogens, variants, subtypes or serotypes from routine surveillance data, American Journal of Epidemiology, 2025;, kwaf119, <a href="https://doi.org/10.1093/aje/kwaf119" class="external-link uri">https://doi.org/10.1093/aje/kwaf119</a></p>
</div>
<div class="section level2">
<h2 id="contribution">Contribution<a class="anchor" aria-label="anchor" href="#contribution"></a>
</h2>
<p>This is a work in progress. If you see any mistakes in the package (branch <code>main</code>) or in the code associated with the analyses for the preprint (branch <code>preprint</code>), let us know by logging a bug on the <a href="https://github.com/acefa-hubs/EpiStrainDynamics/issues" class="external-link">issues</a> page.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the EpiStrainDynamics project is released with a <a href="https://acefa-hubs.github.io/EpiStrainDynamics/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/acefa-hubs/EpiStrainDynamics/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/acefa-hubs/EpiStrainDynamics/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License 2.0</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing EpiStrainDynamics</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Saras Windecker <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-4870-8353" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Oliver Eales <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8086-4495" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>James McCaw <br><small class="roles"> Contributor </small> <a href="https://orcid.org/0000-0002-2452-3098" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Freya Shearer <br><small class="roles"> Contributor </small> <a href="https://orcid.org/0000-0001-9600-3473" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Saras Windecker, Oliver Eales.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
